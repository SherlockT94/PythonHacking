import scanner

target_url = "http://10.0.2.6/dvwa/"
links_to_ignore = ["http://10.0.2.6/dvwa/logout.php"]# When program send request to this page, it will logout and we can not discover any more, so this page should be ignored

data_dict = {"username":"admin", "password":"password", "Login":"submit"}

# target_url = "http://10.0.2.6/mutillidae/"
vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
vuln_scanner.session.post("http://10.0.2.6/dvwa/login.php", data=data_dict)

vuln_scanner.crawl()
vuln_scanner.run_scanner()

# forms = vuln_scanner.extract_forms("http://10.0.2.6/dvwa/vulnerabilities/xss_r/")
# print(forms[0])


# Some test
# Test submit_form() function
# response = vuln_scanner.submit_form(forms[0], "testtest", "http://10.0.2.6/dvwa/vulnerabilities/xss_r/")
# print(response.content.decode())

# Test test_xss_in_form() method
# response = vuln_scanner.test_xss_in_form(forms[0], "http://10.0.2.6/dvwa/vulnerabilities/xss_r/")
# print(response)

# Test test_xss_in_link() method
# response = vuln_scanner.test_xss_in_link("http://10.0.2.6/dvwa/vulnerabilities/xss_r/?name=test")
# print(response)# OUTPUT: True
# response = vuln_scanner.test_xss_in_link("http://10.0.2.6/dvwa/vulnerabilities/xss_r/?page=include.php")
# print(response)# OUTPUT: None
